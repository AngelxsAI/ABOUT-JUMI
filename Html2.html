<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JUMI - Grupo Juvenil Católico</title>
  <!-- Font Awesome para los iconos -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Enlace a la fuente Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
  
  <style>
    /* VARIABLES DE COLOR */
    :root {
      --primary: #6a0dad; /* Morado JUMI */
      --accent: #00bcd4; /* Celeste JUMI */
      --secondary: #000;
      --background: #f8f8ff;
      --text-color: #333;
      --shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    /* ESTILOS GLOBALES Y RESET */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background-color: var(--background);
      color: var(--text-color);
      line-height: 1.6;
      scroll-behavior: smooth;
    }

    a {
      text-decoration: none;
      color: var(--primary);
    }

    /* HEADER */
    header {
      background: linear-gradient(135deg, var(--primary), #8f2fdc);
      color: white;
      padding: 25px 20px; /* Aumentado el padding para el SVG */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      text-align: center;
    }
    .logo {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .cruz-icon {
      /* Estilos para el SVG */
      width: 60px; /* Tamaño de la cruz aumentado */
      height: 60px;
      fill: white;
      margin-bottom: 10px;
      filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.5)); /* Pequeño brillo */
    }
    header h1 {
      font-size: 2.5rem; /* Título más grande */
      font-weight: 900;
      letter-spacing: 3px;
    }
    .header-subtitle {
      font-size: 1rem;
      opacity: 0.9;
      margin-top: 5px;
    }

    /* NAVEGACIÓN */
    .main-nav {
      position: sticky;
      top: 0;
      z-index: 1000;
      background-color: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 15px;
    }
    .nav-links {
      list-style: none;
      display: flex;
      justify-content: center;
      padding: 10px 0;
      flex-wrap: wrap;
    }
    .nav-links li a {
      color: var(--primary);
      padding: 10px 18px;
      display: block;
      font-weight: 600;
      border-radius: 25px;
      transition: var(--transition);
      font-size: 0.95em;
    }
    .nav-links li a:hover {
      background-color: var(--accent);
      color: white;
      transform: translateY(-2px);
    }
    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      color: var(--primary);
      font-size: 1.5rem;
      padding: 15px;
      cursor: pointer;
      width: 100%;
      text-align: left;
    }

    /* VERSÍCULO DEL DÍA */
    #versiculo-del-dia {
      background: linear-gradient(135deg, var(--accent), #7deaf9);
      color: white;
      padding: 25px 15px;
      text-align: center;
      box-shadow: var(--shadow);
      margin: 25px 0;
      border-radius: 15px;
    }
    .contenido-verso {
      max-width: 800px;
      margin: 0 auto;
    }
    .texto-verso {
      font-style: italic;
      font-size: 1.25rem;
      margin-bottom: 15px;
      font-weight: 500;
    }
    .referencia-verso {
      font-weight: 700;
      font-size: 1rem;
      opacity: 0.9;
    }
    .botones-compartir {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    .btn-compartir {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    }
    .btn-compartir:hover {
      background-color: #510a8d;
      transform: translateY(-2px);
    }

    /* SECCIONES GENERALES */
    main {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .section {
      background-color: white;
      padding: 35px;
      margin-bottom: 35px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      opacity: 0; 
      transform: translateY(20px);
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }
    .section.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .section h2 {
      color: var(--primary);
      margin-bottom: 25px;
      border-bottom: 3px solid var(--accent);
      padding-bottom: 10px;
      font-size: 1.8rem;
    }

    /* BOTONES GRUPO */
    .btn-group {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    .btn {
      padding: 12px 25px;
      border-radius: 50px;
      font-weight: 700;
      text-transform: uppercase;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
    }
    .btn-primary {
      background-color: var(--primary);
      color: white;
      border: 2px solid var(--primary);
    }
    .btn-primary:hover {
      background-color: var(--accent);
      border-color: var(--accent);
      transform: scale(1.05);
    }
    .btn-secondary {
      background-color: transparent;
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    .btn-secondary:hover {
      background-color: var(--primary);
      color: white;
    }

    /* GENERADOR DE INSPIRACIÓN */
    #generador-inspiracion {
        text-align: center;
        background-color: #e3f2fd; /* Fondo azul claro */
    }
    #mensajeInput {
        width: 100%;
        min-height: 120px;
        padding: 15px;
        border: 2px solid var(--accent);
        border-radius: 8px;
        margin-bottom: 20px;
        transition: border-color 0.3s;
        font-size: 1rem;
        resize: vertical;
    }
    #mensajeInput:focus {
        border-color: var(--primary);
        outline: none;
    }
    #cartelContainer {
        margin-top: 30px;
        background-color: #fff;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        display: none; /* Oculto por defecto */
    }
    #cartelCanvas {
        max-width: 100%;
        height: auto;
        border: 1px solid #ddd;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        display: block;
        margin: 0 auto;
    }
    #compartirCartelBtn {
        margin-top: 15px;
        background: linear-gradient(90deg, #ffc107, #ff9800);
        color: var(--secondary);
        border: none;
    }
    #compartirCartelBtn:hover {
        background: linear-gradient(90deg, #ff9800, #ffc107);
        color: var(--secondary);
    }

    /* LISTA DE MIEMBROS */
    .members-list {
      list-style: none;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 20px;
      padding: 0;
      text-align: center;
    }
    .members-list li {
      background-color: #f8f8f8;
      padding: 12px;
      border-radius: 8px;
      font-weight: 600;
      color: var(--primary);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
      transition: transform 0.2s;
    }
    .members-list li:hover {
        transform: translateY(-3px);
    }

    /* OTROS ESTILOS DE SECCIÓN (Gallery, Iframes) */
    iframe {
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: 8px;
    }
    .calendar-container, .map-container {
      height: 400px;
      margin-top: 20px;
    }

    /* FOOTER */
    footer {
      background-color: var(--primary);
      color: white;
      padding: 25px;
      text-align: center;
      border-top: 5px solid var(--accent);
    }
    .social-links {
      margin-bottom: 20px;
    }
    .social-links a {
      color: white;
      font-size: 1.8rem;
      margin: 0 12px;
      transition: var(--transition);
    }
    .social-links a:hover {
      color: var(--accent);
      transform: scale(1.2);
    }
    .copyright {
      font-size: 0.9rem;
      margin: 5px 0;
    }

    /* MEDIA QUERIES */
    @media (max-width: 800px) {
        .nav-links {
            display: none;
            flex-direction: column;
            width: 100%;
            padding: 0;
            text-align: center;
        }
        .nav-links.active {
            display: flex;
        }
        .nav-links li {
            width: 100%;
            border-bottom: 1px solid #eee;
        }
        .nav-links li:last-child {
            border-bottom: none;
        }
        .mobile-menu-btn {
            display: block;
        }
        .btn-group {
            justify-content: space-around;
        }
        .btn {
            width: 48%;
            text-align: center;
            justify-content: center;
            font-size: 0.85rem;
        }
        header h1 {
            font-size: 1.8rem;
        }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <!-- Ícono de Cruz SVG Mejorado (Diseño Latin Cross más robusto) -->
        <svg class="cruz-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <path d="M 40 0 L 60 0 L 60 40 L 100 40 L 100 60 L 60 60 L 60 100 L 40 100 L 40 60 L 0 60 L 0 40 L 40 40 L 40 0 Z" fill="white"/>
        </svg>
        <h1>JUMI</h1>
        <p class="header-subtitle">Grupo Juvenil Católico - Encuentra paz, amor y unidad en Cristo</p>
      </div>
    </div>
  </header>

  <nav class="main-nav">
    <div class="nav-container">
      <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i> Menú
      </button>
      <ul class="nav-links" id="navLinks">
        <li><a href="#inicio"><i class="fas fa-home"></i> Inicio</a></li>
        <li><a href="#nosotros"><i class="fas fa-users"></i> Sobre Nosotros</a></li>
        <li><a href="#generador-inspiracion"><i class="fas fa-magic"></i> Cartel</a></li>
        <li><a href="#miembros"><i class="fas fa-user-friends"></i> Miembros</a></li>
        <!-- Sección Álbum Eliminada -->
        <li><a href="#eventos"><i class="fas fa-calendar-alt"></i> Eventos</a></li>
        <li><a href="#ubicacion"><i class="fas fa-map-marker-alt"></i> Ubicación</a></li>
      </ul>
    </div>
  </nav>

  <!-- Contenedor del Versículo (se llena con JS) -->
  <div id="versiculo-del-dia"></div>

  <main>
    <!-- SECCIÓN: Generador de Carteles de Inspiración -->
    <section id="generador-inspiracion" class="section">
      <h2><i class="fas fa-paint-brush"></i> Generador de Carteles de Inspiración</h2>
      <p>Escribe tu mensaje o reflexión. Generaremos un cartel con la imagen de Jesús y el enlace de JUMI, listo para compartir.</p>
      
      <div style="max-width: 600px; margin: 20px auto;">
        <textarea id="mensajeInput" placeholder="Escribe tu mensaje de fe o reflexión (ej. 'La alegría del Señor es nuestra fuerza.')..."></textarea>
        <button id="generarCartelBtn" class="btn btn-primary" style="width: 100%;"><i class="fas fa-wand-magic-sparkles"></i> Generar Cartel</button>
      </div>

      <div id="cartelContainer">
        <h3>Vista Previa del Cartel</h3>
        <canvas id="cartelCanvas"></canvas>
        <button id="compartirCartelBtn" class="btn btn-primary" style="width: 100%; display: none;"><i class="fas fa-share-alt"></i> Compartir Cartel</button>
        <p style="font-size: 0.8em; margin-top: 10px; color: gray;">*El cartel incluye la foto, tu mensaje y el enlace de JUMI.</p>
      </div>
    </section>
    <!-- FIN SECCIÓN GENERADOR -->

    <section id="inicio" class="section">
      <h2><i class="fas fa-cross"></i> Bienvenidos a JUMI</h2>
      <p>JUMI es un espacio creado para jóvenes que buscan crecer en su fe católica, compartir experiencias y formar una comunidad basada en los valores cristianos. Aquí encontrarás un ambiente de amor, respeto y fraternidad donde podrás desarrollar tu espiritualidad.</p>
      <p>Nuestro objetivo es fortalecer la relación con Dios a través de la oración, el estudio de la Biblia y el servicio comunitario. Te invitamos a unirte a nuestras actividades y ser parte de esta maravillosa familia espiritual.</p>

      <div class="btn-group">
        <a href="https://whatsapp.com/channel/0029Vb5M9qLAu3aRABUHvq3q" class="btn btn-primary" target="_blank">
          <i class="fab fa-whatsapp"></i> Unirse al Canal
        </a>
      </div>
    </section>

    <section id="nosotros" class="section">
      <h2><i class="fas fa-church"></i> Sobre Nosotros</h2>
      <p>JUMI (Juventud Misionera) es un grupo católico juvenil dedicado a la formación espiritual de sus miembros. Nuestro nombre refleja nuestra devoción a la Virgen María y nuestro compromiso con la unidad en Cristo.</p>
      <p>Fundado en 2007 nuestro grupo ha crecido gracias al trabajo comprometido de jóvenes que comparten el deseo de profundizar en su fe y servir a la comunidad. Organizamos retiros espirituales, charlas formativas, actividades recreativas y proyectos de servicio social.</p>
      <p>Nuestro lema es "Juventud Misionera, Mas Alla De Las Fronteras", y bajo esta premisa buscamos crear un espacio inclusivo donde todos los jóvenes, sin importar su nivel de conocimiento religioso, puedan sentirse acogidos y acompañados en su camino de fe.</p>
    </section>

    <section id="miembros" class="section">
      <h2><i class="fas fa-users"></i> Nuestros Miembros</h2>
      <p>Conoce a los jóvenes que forman parte de nuestra comunidad JUMI. Juntos trabajamos para crecer en fe y servir a los demás.</p>

      <ul class="members-list">
        <li>Steven</li>
        <li>Daniel</li>
        <li>Oscar</li>
        <li>Kenia</li>
        <li>Valentin</li>
        <li>Rudy</li>
        <li>Angel</li>
        <li>Kevin</li>
        <li>Natalia</li>
        <li>Jaime</li>
        <li>Marvin</li>
        <li>Gissela</li>
        <li>Michael</li>
        <li>Franklin</li>
        <li>Mauricio</li>
        <li>Katty</li>
        <li>Jasmin</li>
      </ul>

      <p style="margin-top: 1.5rem; font-style: italic;">"Porque donde dos o tres se reúnen en mi nombre, allí estoy yo en medio de ellos." - Mateo 18:20</p>
    </section>

    <!-- La sección Álbum Fotográfico ha sido eliminada. -->

    <section id="eventos" class="section">
      <h2><i class="fas fa-calendar-alt"></i> Próximos Eventos</h2>
      <p>Mantente informado sobre nuestras próximas actividades. ¡Te esperamos con alegría!</p>

      <div class="calendar-container">
        <iframe 
          src="https://calendar.google.com/calendar/embed?src=8bf36b5b88e056fd52aee2ee97d1503b2d1fda335e319581bfd7ffecfca1b426%40group.calendar.google.com&ctz=America%2FEl_Salvador"
          title="Calendario de Eventos JUMI"
          frameborder="0" 
          scrolling="no">
        </iframe>
      </div>
    </section>

    <section id="ubicacion" class="section">
      <h2><i class="fas fa-map-marked-alt"></i> Ubicación</h2>
      <p>Nuestras reuniones se llevan a cabo en la Iglesia Católica de la Colonia San Francisco Guajoyo. ¡Ven y únete a nosotros!</p>

      <div class="map-container">
        <iframe 
          src="https://maps.google.com/maps?q=Iglesia%20Católica%20Colonia%20San%20Francisco%20Guajoyo&t=&z=15&ie=UTF8&iwloc=&output=embed" 
          title="Ubicación de JUMI"
          allowfullscreen="" 
          loading="lazy">
        </iframe>
      </div>

      <div class="btn-group" style="margin-top: 1.5rem;">
        <a href="https://maps.app.goo.gl/TU_ENLACE_A_DIRECCIONES_AQUÍ" class="btn btn-primary" target="_blank">
          <i class="fas fa-directions"></i> Cómo llegar
        </a>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <div class="social-links">
        <a href="https://www.instagram.com/jumi_medalla.milagrosa?igsh=MXVsdmV0ZTR2bW40ZA==" target="_blank" aria-label="Instagram JUMI"><i class="fab fa-instagram"></i></a>
        <a href="https://whatsapp.com/channel/0029Vb5M9qLAu3aRABUHvq3q" target="_blank" aria-label="Canal WhatsApp"><i class="fab fa-whatsapp"></i></a>
        <a href="mailto:orgjumi@gmail.com" target="_blank" aria-label="Correo electrónico"><i class="fas fa-envelope"></i></a>
      </div>
      <p class="copyright">© 2025 JUMI - Juventud Misionera</p>
      <p class="copyright">Desarrollado con amor por Angel para la comunidad JUMI</p>
    </div>
  </footer>

  <!-- SCRIPTS -->
  <script>
    // URL y constantes actualizadas
    const URL_JUMI = "https://about-jumi.vercel.app/";
    const NOMBRE_IMAGEN_CARTEL = "Jesus.jpg"; 

    // Gestor del versículo diario
    const gestorVersiculo = {
        versiculos: [
          {
            texto: "A toda perfección le he visto límite, pero tus mandamientos son ilimitados.",
            referencia: "Salmos 119:96"
          },
          {
            texto: "Pedid, y se os dará; buscad, y hallaréis; llamad, y se os abrirá.",
            referencia: "Mateo 7:7"
          },
          {
            texto: "El Señor es mi pastor, nada me faltará.",
            referencia: "Salmos 23:1"
          },
          {
            texto: "Todo lo puedo en Cristo que me fortalece.",
            referencia: "Filipenses 4:13"
          },
          {
            texto: "Porque donde dos o tres se reúnen en mi nombre, allí estoy yo en medio de ellos.",
            referencia: "Mateo 18:20"
          }
        ],

        iniciar() {
          this.configurarEventos();
          this.cargarVersiculo();
          setInterval(() => this.cargarVersiculo(), 86400000); 
        },

        configurarEventos() {
          // Menú móvil
          document.getElementById('mobileMenuBtn').addEventListener('click', () => {
            document.getElementById('navLinks').classList.toggle('active');
          });

          // Scroll suave
          document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
              e.preventDefault();
              document.getElementById('navLinks').classList.remove('active'); 
              const target = document.querySelector(this.getAttribute('href'));
              if (target) {
                 window.scrollTo({
                  top: target.offsetTop - 100,
                  behavior: 'smooth'
                });
              }
            });
          });
          
          // Evento para el generador de carteles
          const btnGenerarCartel = document.getElementById('generarCartelBtn');
          if (btnGenerarCartel) {
              btnGenerarCartel.addEventListener('click', generarCartelInspiracion);
          }

          // Evento para compartir el cartel generado
          const btnCompartirCartel = document.getElementById('compartirCartelBtn');
          if (btnCompartirCartel) {
              btnCompartirCartel.addEventListener('click', compartirCartel);
          }
        },

        async cargarVersiculo() {
          try {
            const respuesta = await fetch('https://beta.ourmanna.com/api/v1/get/?format=json&version=RVR1960');
            if (!respuesta.ok) throw new Error('Error al obtener el versículo de la API');
            const data = await respuesta.json();
            
            const texto = data.verse.details.text;
            if (texto && !/you|your|the|is|of|and|but/i.test(texto)) {
                this.mostrarVersiculo(data.verse.details.text, data.verse.details.reference);
            } else {
                throw new Error('Versículo de la API no es válido o está en inglés');
            }
          } catch (error) {
            console.error("Usando versículo local:", error.message);
            this.usarVersiculoLocal();
          }
        },

        usarVersiculoLocal() {
          const hoy = new Date();
          const indice = hoy.getDate() % this.versiculos.length; 
          this.mostrarVersiculo(
            this.versiculos[indice].texto,
            this.versiculos[indice].referencia
          );
        },

        mostrarVersiculo(texto, referencia) {
          const contenedor = document.getElementById('versiculo-del-dia');
          if (!contenedor) return; 

          contenedor.innerHTML = `
            <div class="contenido-verso">
              <p class="texto-verso">"${texto}"</p>
              <p class="referencia-verso">${referencia}</p>
              <div class="botones-compartir">
                <button class="btn-compartir" onclick="compartirVersiculo()">
                  <i class="fas fa-share"></i> Compartir
                </button>
                <a href="https://wa.me/?text=${encodeURIComponent(`Versículo del Día JUMI: "${texto}" - ${referencia} \nConoce más en: ${URL_JUMI}`)}" 
                   class="btn-compartir" 
                   target="_blank">
                  <i class="fab fa-whatsapp"></i> WhatsApp
                </a>
              </div>
            </div>
          `;
        }
    };

    // Función para compartir el Versículo del Día 
    function compartirVersiculo() {
        const texto = document.querySelector('.texto-verso').textContent;
        const referencia = document.querySelector('.referencia-verso').textContent;
        const textoFinal = `Versículo del Día JUMI: ${texto} - ${referencia}\n\nConoce más en: ${URL_JUMI}`;
        
        if (navigator.share) {
          navigator.share({
            title: 'Versículo del Día - JUMI',
            text: textoFinal
          }).catch(error => console.log('Error al compartir:', error));
        } else {
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(textoFinal)}`;
            window.open(whatsappUrl, '_blank');
        }
    }

    // --- FUNCIONALIDAD: GENERADOR DE CARTELES CON CANVAS ---

    const CARTEL_WIDTH = 800;
    const CARTEL_HEIGHT = 600;

    function wrapText(context, text, x, y, maxWidth, lineHeight) {
        const words = text.split(' ');
        let line = '';
        let currentY = y;

        for(let n = 0; n < words.length; n++) {
            const testLine = line + words[n] + ' ';
            const metrics = context.measureText(testLine);
            const testWidth = metrics.width;
            
            if (testWidth > maxWidth && n > 0) {
                context.fillText(line, x, currentY);
                line = words[n] + ' ';
                currentY += lineHeight;
            } else {
                line = testLine;
            }
        }
        context.fillText(line, x, currentY);
        return currentY; // Retorna la altura final para cálculos
    }

    function generarCartelInspiracion() {
        const mensaje = document.getElementById('mensajeInput').value.trim();
        const canvas = document.getElementById('cartelCanvas');
        const ctx = canvas.getContext('2d');
        const cartelContainer = document.getElementById('cartelContainer');
        const compartirBtn = document.getElementById('compartirCartelBtn');
        
        if (!mensaje) {
            return alert("Por favor, escribe un mensaje de inspiración antes de generar el cartel.");
        }

        // Configurar dimensiones del canvas
        canvas.width = CARTEL_WIDTH;
        canvas.height = CARTEL_HEIGHT;

        const img = new Image();
        img.crossOrigin = 'Anonymous'; // Necesario para evitar problemas de CORS si la imagen viene de otro dominio
        img.src = NOMBRE_IMAGEN_CARTEL; // Jesus.jpg

        img.onload = () => {
            // 1. Dibujar la Imagen (como fondo)
            // Escalar la imagen para que cubra todo el canvas (aspecto "cover")
            const scale = Math.max(CARTEL_WIDTH / img.width, CARTEL_HEIGHT / img.height);
            const x = (CARTEL_WIDTH / 2) - (img.width / 2) * scale;
            const y = (CARTEL_HEIGHT / 2) - (img.height / 2) * scale;
            ctx.drawImage(img, x, y, img.width * scale, img.height * scale);

            // 2. Aplicar un gradiente/capa semi-transparente para mejorar el contraste del texto
            ctx.fillStyle = 'rgba(0, 0, 0, 0.4)'; // Negro semi-transparente
            ctx.fillRect(0, 0, CARTEL_WIDTH, CARTEL_HEIGHT);

            // 3. Dibujar el Mensaje (Texto del usuario)
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.font = '700 48px Poppins';
            const lineHeight = 60;
            const maxWidth = CARTEL_WIDTH - 100;
            const xPos = CARTEL_WIDTH / 2;
            let startY = CARTEL_HEIGHT / 2 - (Math.floor(mensaje.length / 20) * (lineHeight / 2)); // Centrado vertical aproximado

            // Dibuja la sombra (stroke) del texto para mejor legibilidad
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.8)';
            ctx.lineWidth = 2;
            ctx.font = '700 48px Poppins';
            
            // Usamos un loop para el stroke y fill
            const words = mensaje.split(' ');
            let line = '';
            let currentY = startY;

            for(let n = 0; n < words.length; n++) {
                const testLine = line + words[n] + ' ';
                const metrics = ctx.measureText(testLine);
                const testWidth = metrics.width;
                
                if (testWidth > maxWidth && n > 0) {
                    ctx.strokeText(line, xPos, currentY);
                    ctx.fillText(line, xPos, currentY);
                    line = words[n] + ' ';
                    currentY += lineHeight;
                } else {
                    line = testLine;
                }
            }
            ctx.strokeText(line, xPos, currentY);
            ctx.fillText(line, xPos, currentY);

            // 4. Dibujar el Enlace de Atribución (pequeño en la esquina)
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.textAlign = 'right';
            ctx.font = '200 18px Poppins';
            ctx.fillText(`Visítanos: ${URL_JUMI}`, CARTEL_WIDTH - 20, CARTEL_HEIGHT - 20);

            // Mostrar el cartel y el botón de compartir
            cartelContainer.style.display = 'block';
            compartirBtn.style.display = 'block';
        };

        img.onerror = () => {
             // Fallback si la imagen no se encuentra
            ctx.fillStyle = '#6a0dad';
            ctx.fillRect(0, 0, CARTEL_WIDTH, CARTEL_HEIGHT);
            
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.font = '700 36px Poppins';
            wrapText(ctx, mensaje, CARTEL_WIDTH / 2, CARTEL_HEIGHT / 3, CARTEL_WIDTH - 80, 50);

            ctx.font = '300 24px Poppins';
            ctx.fillText("¡Carga la imagen 'Jesus.jpg' para el fondo!", CARTEL_WIDTH / 2, CARTEL_HEIGHT - 100);

            ctx.font = '200 18px Poppins';
            ctx.fillText(`Visítanos: ${URL_JUMI}`, CARTEL_WIDTH - 20, CARTEL_HEIGHT - 20);

            cartelContainer.style.display = 'block';
            compartirBtn.style.display = 'block';
            console.warn("ADVERTENCIA: No se pudo cargar la imagen 'Jesus.jpg'. Se generó un cartel con fondo plano.");
        };
    }

    // Función para compartir la imagen del canvas
    async function compartirCartel() {
        const canvas = document.getElementById('cartelCanvas');
        const mensaje = document.getElementById('mensajeInput').value.trim();

        try {
            // Convertir el Canvas a Blob
            const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/jpeg', 0.9));
            if (!blob) throw new Error("Fallo al crear el Blob de la imagen.");

            const file = new File([blob], "Cartel_JUMI.jpg", { type: 'image/jpeg' });
            
            const shareData = {
                title: "Inspiración JUMI",
                text: `¡Mira mi mensaje de fe!\n\n${mensaje}\n\nConoce JUMI: ${URL_JUMI}`,
                files: [file]
            };

            if (navigator.canShare && navigator.canShare(shareData)) {
                await navigator.share(shareData);
            } else {
                throw new Error("El navegador no soporta compartir archivos nativamente.");
            }

        } catch (err) {
            console.error("Error al compartir el cartel:", err);
            // Fallback: Descargar la imagen
            const imageURL = canvas.toDataURL('image/jpeg', 0.9);
            const a = document.createElement('a');
            a.href = imageURL;
            a.download = 'Cartel_Inspiracion_JUMI.jpg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            alert("Tu navegador no soporta compartir directamente. Se ha descargado la imagen. Puedes compartirla manualmente en WhatsApp.");
        }
    }
    
    // Inicialización al cargar el DOM
    document.addEventListener('DOMContentLoaded', () => {
        gestorVersiculo.iniciar();

        // Animación de secciones
        const observer = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
              observer.unobserve(entry.target);
            }
          });
        }, { threshold: 0.1 });

        document.querySelectorAll('.section').forEach(seccion => {
          observer.observe(seccion);
        });
    });

  </script>

